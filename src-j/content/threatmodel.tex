\section{Threat Model}
\begin{figure}
    \centering
    \includegraphics[width=0.95\linewidth]{content//figures/threatmodel.pdf}
    \caption{Data flow diagram employed for our threat model}
    \label{fig:threatmodel:dataflow}
\end{figure}
\begin{table}[t]
\label{table:threatmodel:threats}
\resizebox{\textwidth}{!}{%
    \centering
    \begin{tabular}{llll}\toprule
        \textbf{ID} & \textbf{Trust boundary}& \textbf{Type}  & \textbf{Threat description}\\ \midrule
        T04& \multirow{4}{*}{\makecell[l]{TB01}}& Information disclosure  & The attacker accesses the \Compo{Secure Miner}'s memory location to leak the event logs\\ 
        T05& & Tampering  & The attacker meddles the source code of the \Compo{Secure Miner} or its event log data\\
        T06& & Elevation of privileges  & The attacker gains the rights to run in the same environment of the \Compo{Secure Miner}\\
        T07& & Denial of service  & The \Compo{Secure Miner} crashes, halts or stops\\ \midrule
        T08& \multirow{5}{*}{\makecell[l]{TB02}}& Spoofing  & The attacker impersonates a \Compo{Secure Miner} to gain access to the \Compo{Provisioner}'s log\\ 
        T09& & Spoofing  & The attacker impersonates a \Compo{Provisioner} to communicate with the \Compo{Secure Miner}\\
        T10& & Denial of service &The \Compo{Secure Miner} floods the \Compo{Provisioner} with log requests\\
        T11& & Information disclosure & The attacker sniffs the \Compo{Provisioner}'s log sent to the \Compo{Secure Miner}\\ 
        T12& & Tampering & The attacker alters the data flow between the \Compo{Provisioner} and the \Compo{Secure Miner}\\ \midrule
        T01& \multirow{3}{*}{\makecell[l]{TB03}}& Spoofing   & The attacker impersonates a legitimate interactor to use the \Compo{Secure Miner}\\
        T02&     & Tampering  & The intra-organizational interactor sends malicious input to the \Compo{Secure Miner}\\
        T03&     & Information disclosure  & The attacker sniffs the messages between the interactor and the \Compo{Secure Miner}\\
        \bottomrule
        
    \end{tabular}
    \caption{Vulnerabilities in the CONFINE architecture}
}
\end{table}
\begin{newj}
	

In the following section, we identify the threats that can jeopardize the proper functioning of CONFINE. Our threat analysis is based upon the theoretical foundation of the \textit{STRIDE} framework \cite{aa}. This conceptual model groups the threats into six categories: spoofing (i.e., the impersonation of a legitimate entity), tampering (i.e., the modification of data to alter its integrity), repudiation (i.e., the denial of performing a particular action), information disclosure (i.e., the exposure of sensitive data), denial of service (i.e., the disruption or degradation of availability) and elevation of privileges (i.e., the misappropriation of higher level of rights). 

With the help of the dataflow depicted in \cref{fig:threatmodel:dataflow}, we demarcate the \textit{trust boundaries} among the CONFINE components. In our diagram, a trust boundary box (a red dashed square) groups entities with mutual trust. Differently, trust boundary arches (red dashed curved lines) mark the transitions of trust level on the occasion of data exchanges between mutually untrusted interactors. We identified the three main trust boundaries: the Secure Miner's trust boundary (\textbf{TB01}), the inter-organizational trust boundary (\textbf{TB02}), and the intra-organizational trust boundary (\textbf{TB03}). As a result of our analysis, we collect in \cref{table:threatmodel:threats} the CONFINE threats according to the STRIDE taxonomy.

We address the identified threats, grouping them according to the threat boundary they refer to.  
	
%The trust boundary box TB01 groupes the components of the \Compo{Secure Miner}. The spectrum of the possible attacks to this boundary aims at breaking the isolation layer separating the \Compo{Secure Miner}'s component from untrusted entities. In order to disclosure the \Compo{Secure Miner}'s confidential information, a malicious actor may get access to the memory portion allocated to the \Compo{Secure Miner} (e.g., via Direct Memory Access attack) revealing event log's sensitive information (\textbf{T04}). Tampering threats manifest as the manipulation of the \Compo{Secure Miner}'s source code and event log data to generate misbehaviours or introducing vulnerabilities (\textbf{T05}). Furthermore, a malicious actor could acquire the necessary privileges (e.g., via kernel exploits) to execute code within the isolated context of the \Compo{Secure Miner}, potentially leading to unauthorized access or malicious code injection (\textbf{T06}). A denial-of-service attack may be employed a malicious entity to crash, halt, or disrupt the functioning of the \Compo{Secure Miner}, thereby impeding its ability to correctly aggregate event logs data and provide output analytics (\textbf{T07}).
The trust boundary box TB01 encloses the components of the \Compo{Secure Miner}. The spectrum of potential attacks targeting this trust domain aims to undermine the isolation layer that separates the components of the \Compo{Secure Miner} from untrusted entities. Attacks against this trust boundary may emanate from a generic entity, which could be either intra-organizational (i.e., within the same organization as the \Compo{Secure Miner}) or inter-organizational (i.e., beyond the boundaries of the \Compo{Secure Miner}'s organization). To expose the confidential information within the \Compo{Secure Miner}, a malicious actor might gain access to the memory allocated to the \Compo{Secure Miner}, for instance, through a Direct Memory Access attack\cite{cita}, thereby revealing event logs' sensitive information (\textbf{T04}). Tampering threats materialize in the form of manipulating the \Compo{Secure Miner}'s source code and event log data to induce misbehaviors or introduce vulnerabilities (\textbf{T05}). Furthermore, a malicious actor could obtain the necessary privileges, such as through kernel exploits, to execute code within the isolated context of the \Compo{Secure Miner}, potentially resulting in unauthorized access or the injection of malicious code (\textbf{T06}). A denial-of-service attack may be employed by a malicious entity to crash, halt, or disrupt the functioning of the \Compo{Secure Miner}, thereby hindering the aggregation event log data correctly and the outsourcing of result analytics (\textbf{T07}). 

%TB02 shows the trust transition between the \Compo{Secure Miner} and the \Compo{Provisioner}. In this case, the attacker could interfere in the data transmission process through which event logs are delivered from the \Compo{Provisioner} to the \Compo{Secure Miner}. A spoofing attack could lead to the \Compo{Secure Miner} impersonation to improperly receive the \Compo{Provisioner}'s event log (\textbf{TB08}). Similarly, if an attacker impersonates a \Compo{Provisioner}, it could send fake event logs to affect the data analytics output. The log delivery service could be interrupted by one or more malicious entities that generate an outsized number of data requests (e.g., via DDoS attack) toward the target \Compo{Provisioner} (\textbf{TB10}). A man in the middle attack, such as eavesdropping or packet sniffing, could enable a third-party actor to monitor the dataflow between the \Compo{Secure Miner} and the \Compo{Provisioner}, making it capable of disclosing personal information (\textbf{TB11}) or alter meaningful data (\textbf{TB12}). 
TB02  encompasses inter-organizational concerns between the \Compo{Secure Miner} and the \Compo{Provisioner}. Considering this specific setting, an attacker may disrupt the data transmission process responsible for delivering event logs from the \Compo{Provisioner} to the \Compo{Secure Miner}. A spoofing attack could result in the \Compo{Secure Miner} being impersonated, leading to the improper reception of the \Compo{Provisioner}'s event log (\textbf{T08}). Similarly, if an attacker successfully impersonates a \Compo{Provisioner}, it could send fabricated event logs to manipulate the data analytics output. Furthermore, the log delivery service may be interrupted by one or more malicious entities generating an excessive number of data requests (e.g., through a DDoS attack) targeting the \Compo{Provisioner} (\textbf{T10}). A man-in-the-middle attack, such as eavesdropping or packet sniffing, could allow a third-party actor to monitor the data flow between the \Compo{Secure Miner} and the \Compo{Provisioner}, thereby enabling the disclosure of event logs' confidential information (\textbf{T11}) or the alteration of meaningful data (\textbf{T12}).

Lastly, the TB03 trust boundary pertains to intra-organizational concerns involving the interaction between the \Compo{Secure Miner} and a generic intra-organizational interactor within the same organization. A spoofing attack  A spoofing threat holds the potential for an assailant to emulate a legitimate interactor, enabling them to engage with the \Compo{Secure Miner} (\textbf{T01}).% Additionally, a legitimate interactor with malicious intent may introduce detrimental inputs to the \Compo{Secure Miner}, including the submission of corrupted data or dangerous commands (\textbf{T02}).
Furthermore, there exists a risk wherein a legitimate interactor, motivated by malicious intent, may introduce deleterious inputs to the \Compo{Secure Miner}, including the submission of corrupted data or issuance of dangerous commands (\textbf{T02}). The emergence of information disclosure threats, as highlighted, transpires when a malicious actor intercepts messages exchanged between a legitimate interactor and the \Compo{Secure Miner}, thereby attaining unauthorized access to sensitive information, including credentials or reserved outputs (\textbf{T03}).
\end{newj}


